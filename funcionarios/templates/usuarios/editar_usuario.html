{% extends "base.html" %}
{% block title %}Editar Usuario{% endblock %}

{% block content %}
<h2 class="mb-4 text-center">âœï¸ Editar Usuario</h2>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-success text-center">{{ message }}</div>
    {% endfor %}
{% endif %}

<form method="post" class="card p-4 shadow-sm" style="max-width: 500px; margin: auto;">
    {% csrf_token %}

    <!-- RUT (no editable) -->
    <div class="mb-3">
        <label for="rut" class="form-label">RUT</label>
        <input type="text" class="form-control" name="rut" id="rut" value="{{ usuario.rut }}" readonly>
    </div>

    <!-- Nombres -->
    <div class="mb-3">
        <label for="first_name" class="form-label">Nombres</label>
        <input type="text" class="form-control" name="first_name" id="first_name"
               value="{{ usuario.user.first_name }}" required>
    </div>

    <!-- Apellidos -->
    <div class="mb-3">
        <label for="last_name" class="form-label">Apellidos</label>
        <input type="text" class="form-control" name="last_name" id="last_name"
               value="{{ usuario.user.last_name }}" required>
    </div>

    <!-- Rol -->
    <div class="mb-3">
        <label for="rol" class="form-label">Rol</label>
        <select class="form-select" name="rol" id="rol" required>
            <option value="administrador" {% if usuario.rol == "administrador" %}selected{% endif %}>Administrador</option>
            <option value="oficial_guardia" {% if usuario.rol == "oficial_guardia" %}selected{% endif %}>Oficial de Guardia</option>
            <option value="funcionario" {% if usuario.rol == "funcionario" %}selected{% endif %}>Funcionario</option>
        </select>
    </div>

    <!-- Unidad Policial -->
    <div class="mb-3">
        <label for="unidad_policial" class="form-label">Unidad Policial</label>
        <select class="form-select" name="unidad_policial" id="unidad_policial" required>
            {% for unidad in unidades %}
                <option value="{{ unidad.id }}" {% if usuario.unidad_policial and usuario.unidad_policial.id == unidad.id %}selected{% endif %}>
                    {{ unidad.nombre }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="text-center mt-3">
        <button type="submit" class="btn btn-success">ğŸ’¾ Guardar Cambios</button>
        <a href="{% url 'lista_usuarios' %}" class="btn btn-secondary">â¬…ï¸ Volver</a>
    </div>
</form>
{% endblock %}

