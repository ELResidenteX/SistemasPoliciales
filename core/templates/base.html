<!DOCTYPE html>
<html lang="es">
<head>
    {% load static %}
    <meta charset="UTF-8">

    <title>{% block title %}GeoDepol{% endblock %}</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Fuente moderna -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        /* ==========================
           ESTILO GLOBAL
        ========================== */
        body {
            background: #0d1117;              /* Fondo dark */
            font-family: "Inter", sans-serif;
            color: #e5e7eb;
            overflow-x: hidden;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .container-dashboard {
            max-width: 1500px;
            margin: auto;
            padding: 40px 30px;
        }

        /* ==========================
           HERO SUPERIOR
        ========================== */
        .hero-card {
            background: rgba(255,255,255,0.03);
            backdrop-filter: blur(12px);
            border-radius: 22px;
            padding: 45px 50px;
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 0 50px rgba(0,0,0,0.45);
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .hero-sub {
            font-size: 1rem;
            color: #9ca3af;
            margin-bottom: 25px;
            max-width: 650px;
        }

        .btn-blue {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 26px;
            border-radius: 7px;
            font-weight: 500;
            margin-right: 10px;
        }

        .btn-blue:hover {
            background: #2563eb;
        }

        .btn-secondary-modern {
            background: #1f2937;
            color: #d1d5db;
            border: 1px solid #374151;
            padding: 10px 26px;
            border-radius: 7px;
            font-weight: 500;
        }

        .btn-secondary-modern:hover {
            background: #111827;
        }

        .tag {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(255,255,255,0.12);
            color: #d1d5db;
            border-radius: 6px;
            font-size: 0.75rem;
            margin-bottom: 10px;
        }

        /* ==========================
           MÉTRICAS LATERALES
        ========================== */
        .metric-box {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            padding: 18px 22px;
            border-radius: 14px;
            margin-bottom: 12px;
        }

        .metric-number {
            font-size: 1.8rem;
            font-weight: 600;
            color: #3b82f6;
        }

        .metric-label {
            font-size: 0.86rem;
            color: #9ca3af;
        }

        /* ==========================
           BARRA DE INFO DE USUARIO
        ========================== */
        .user-info-bar {
            background: rgba(34,197,94,0.10);
            border-left: 4px solid #22c55e;
            border-radius: 8px;
            padding: 8px 14px;
            font-size: 0.85rem;
            margin-bottom: 25px;
            color: #bbf7d0;
        }

        /* ==========================
           TARJETAS DE MÓDULOS GRANDES
        ========================== */
        .module-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 24px 24px 20px;
            backdrop-filter: blur(12px);
            box-shadow: 0 0 45px rgba(0,0,0,0.3);
            margin-bottom: 25px;
        }

        .module-header-label {
            font-size: 0.76rem;
            text-transform: uppercase;
            color: #9ca3af;
            margin-bottom: 6px;
        }

        .module-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .module-subtitle {
            color: #9ca3af;
            font-size: 0.86rem;
            margin-bottom: 16px;
        }

        /* Bloque clickeable por opción */
        .module-option {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 10px;
            border-radius: 10px;
            margin-bottom: 6px;
            transition: background 0.18s ease, transform 0.18s ease;
        }

        .module-option:hover {
            background: rgba(255,255,255,0.08);
            transform: translateY(-1px);
        }

        .bullet {
            width: 8px;
            height: 8px;
            background: #3b82f6;
            border-radius: 50%;
            margin-top: 7px;
            flex-shrink: 0;
        }

        .option-text {
            display: flex;
            flex-direction: column;
        }

        .option-title {
            font-size: 0.96rem;
            font-weight: 500;
        }

        .option-desc {
            font-size: 0.82rem;
            color: #9ca3af;
        }

        /* ==========================
           PANELS INFERIORES
        ========================== */
        .panel-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 18px;
            padding: 28px;
            backdrop-filter: blur(12px);
            margin-bottom: 35px;
        }

        .panel-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .list-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.06);
        }

        .list-item-title {
            font-weight: 500;
        }

        .list-item small {
            color: #9ca3af;
        }

        /* Responsive básico */
        @media (max-width: 991px) {
            .hero-card {
                padding: 30px 24px;
            }
        }
    </style>

</head>
<body>

<div class="container-dashboard">

    <!-- ==========================
         HERO PRINCIPAL
         (título, texto, CTA y métricas)
    ========================== -->
    <div class="hero-card">
        <div class="tag">GeoDepol · Centro Operativo</div>

        <h1 class="hero-title">Gestión integral de eventos y partes en tiempo real</h1>

        <p class="hero-sub">
            Coordina eventos policiales, valida reportes, gestiona partes e información operativa
            manteniendo trazabilidad completa de cada procedimiento.
        </p>

        <!-- Botones de acción principal -->
        <a href="{% url 'nuevo_evento' %}" class="btn-blue">Crear evento policial</a>
        <a href="{% url 'manuales_usuario' %}" class="btn-secondary-modern">Manual del sistema</a>

        <!-- Métricas del lado derecho -->
        <div class="row mt-4">
            <div class="col-md-3 offset-md-9">
                <div class="metric-box">
                    <div class="metric-number">24</div>
                    <div class="metric-label">Eventos activos</div>
                </div>
                <div class="metric-box">
                    <div class="metric-number">8</div>
                    <div class="metric-label">En validación</div>
                </div>
                <div class="metric-box">
                    <div class="metric-number">12</div>
                    <div class="metric-label">Partes registrados hoy</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==========================
         INFO DEL USUARIO LOGUEADO
    ========================== -->
    {% if request.user.is_authenticated and request.user.perfilusuario %}
    <div class="user-info-bar">
        Usuario: {{ nombre_usuario }} · Rol: {{ rol_usuario }} · Unidad:
        {% if unidad_usuario %}
            {{ unidad_usuario }}
        {% else %}
            No asignada
        {% endif %}
    </div>
    {% endif %}

    <!-- ==========================
         MÓDULOS PRINCIPALES COMO CUADRADOS GRANDES
         (Eventos, Tránsito, Constancias, etc.)
    ========================== -->
    <div class="row">

        <!-- Módulo: Eventos Policiales -->
        <div class="col-md-4">
            <div class="module-card">
                <!-- Cabecera del módulo -->
                <div class="module-header-label">Módulo</div>
                <div class="module-title">Eventos Policiales</div>
                <div class="module-subtitle">
                    Registro, consulta y validación de eventos y partes policiales.
                </div>

                <!-- Opción: Nuevo evento -->
                <a href="{% url 'nuevo_evento' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Nuevo evento policial</span>
                        <span class="option-desc">Crear un nuevo registro de incidente con sus datos operativos.</span>
                    </div>
                </a>

                <!-- Opción: Buscar evento -->
                <a href="{% url 'buscar_evento' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Buscar evento</span>
                        <span class="option-desc">Consultar eventos por número, fecha, lugar o unidad responsable.</span>
                    </div>
                </a>

                <!-- Opción: Eventos en validación -->
                <a href="{% url 'evento_en_validacion' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Eventos en validación</span>
                        <span class="option-desc">Revisar procedimientos pendientes de validación y cierre.</span>
                    </div>
                </a>

                <!-- Opción: Repositorio de partes -->
                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Repositorio de partes</span>
                        <span class="option-desc">Acceso al histórico de partes policiales registrados en la unidad.</span>
                    </div>
                </a>

                <!-- Opción: Actas del detenido -->
                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Actas del detenido</span>
                        <span class="option-desc">Registro y consulta de actas asociadas a detenidos.</span>
                    </div>
                </a>

                <!-- Opción: Búsqueda de partes -->
                <a href="{% url 'vista_busqueda_partes' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Búsqueda de partes</span>
                        <span class="option-desc">Localizar partes por número, fecha, denunciante o funcionario.</span>
                    </div>
                </a>
            </div>
        </div>

        <!-- Módulo: Infracción al Tránsito -->
        <div class="col-md-4">
            <div class="module-card">
                <div class="module-header-label">Módulo</div>
                <div class="module-title">Infracción al Tránsito</div>
                <div class="module-subtitle">
                    Gestión de infracciones de tránsito y partes asociados.
                </div>

                <a href="{% url 'nueva_infraccion' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Nueva infracción</span>
                        <span class="option-desc">Registrar una nueva infracción de tránsito con todos sus antecedentes.</span>
                    </div>
                </a>

                <a href="{% url 'vista_busqueda_partes_infracciones' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Buscar infracción</span>
                        <span class="option-desc">Consultar infracciones emitidas según número, patente o fecha.</span>
                    </div>
                </a>
            </div>
        </div>

        <!-- Módulo: Constancias -->
        <div class="col-md-4">
            <div class="module-card">
                <div class="module-header-label">Módulo</div>
                <div class="module-title">Constancias</div>
                <div class="module-subtitle">
                    Registro de constancias y certificados solicitados por la comunidad.
                </div>

                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Nueva constancia</span>
                        <span class="option-desc">Ingresar una nueva constancia con los datos del solicitante.</span>
                    </div>
                </a>

                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Buscar constancia</span>
                        <span class="option-desc">Buscar constancias emitidas según fecha, motivo o persona.</span>
                    </div>
                </a>
            </div>
        </div>

        <!-- Módulo: Otras Infracciones -->
        <div class="col-md-4">
            <div class="module-card">
                <div class="module-header-label">Módulo</div>
                <div class="module-title">Otras Infracciones</div>
                <div class="module-subtitle">
                    Controles y fiscalizaciones especiales de apoyo a la gestión.
                </div>

                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Control vehicular</span>
                        <span class="option-desc">Registrar controles vehiculares y sus resultados.</span>
                    </div>
                </a>

                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Control entidades financieras</span>
                        <span class="option-desc">Registrar fiscalizaciones en bancos y entidades financieras.</span>
                    </div>
                </a>

                <a href="#" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Fiscalización de alcoholes</span>
                        <span class="option-desc">Controlar cumplimiento de normativa de expendio de alcoholes.</span>
                    </div>
                </a>
            </div>
        </div>

        <!-- Módulo: Estadísticas -->
        <div class="col-md-4">
            <div class="module-card">
                <div class="module-header-label">Módulo</div>
                <div class="module-title">Estadísticas</div>
                <div class="module-subtitle">
                    Visualización geográfica y análisis de eventos registrados.
                </div>

                <a href="{% url 'estadisticas_geolocalizacion' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Mapa de geolocalización</span>
                        <span class="option-desc">Visualizar eventos sobre el mapa para identificar patrones y zonas críticas.</span>
                    </div>
                </a>
            </div>
        </div>

        <!-- Módulo: Otros / Configuración -->
        <div class="col-md-4">
            <div class="module-card">
                <div class="module-header-label">Configuración</div>
                <div class="module-title">Otros</div>
                <div class="module-subtitle">
                    Opciones de cuenta, soporte y administración del sistema.
                </div>

                <a href="{% url 'cambio_clave' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Cambio de clave</span>
                        <span class="option-desc">Actualizar la contraseña de acceso al sistema.</span>
                    </div>
                </a>

                <a href="{% url 'manuales_usuario' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Manuales de usuario</span>
                        <span class="option-desc">Descargar o revisar documentos de ayuda y procedimientos.</span>
                    </div>
                </a>

                {% if request.user.perfilusuario.rol == "super_admin" or request.user.perfilusuario.rol == "administrador" %}
                <a href="{% url 'crear_usuario' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Configuración de usuarios</span>
                        <span class="option-desc">Crear, modificar y administrar cuentas de usuarios del sistema.</span>
                    </div>
                </a>
                {% endif %}

                <a href="{% url 'logout' %}" class="module-option">
                    <span class="bullet"></span>
                    <div class="option-text">
                        <span class="option-title">Salir del sistema</span>
                        <span class="option-desc">Cerrar sesión de GeoDepol de forma segura.</span>
                    </div>
                </a>
            </div>
        </div>

    </div>

    <!-- ==========================
         PANEL INFERIOR: CONTENIDO + BITÁCORA
    ========================== -->
    <div class="row mt-3">

        <!-- Panel: Eventos en validación (usa tu block content habitual) -->
        <div class="col-md-8">
            <div class="panel-card">
                <div class="tag">Eventos · Validación</div>
                <div class="panel-title">Eventos en validación</div>

                {% block content %}
                {% include "core/presentacion.html" %}
                {% endblock %}
            </div>
        </div>

        <!-- Panel: Bitácora en vivo -->
        <div class="col-md-4">
            <div class="panel-card">
                <div class="tag">Bitácora · Operativa</div>
                <div class="panel-title">Bitácora en vivo</div>
                <p class="hero-sub" style="font-size:0.86rem; margin-bottom:12px;">
                    Últimas actualizaciones registradas en el sistema.
                </p>

                <div class="list-item">
                    <div class="list-item-title">Evento EVT-221 actualizado</div>
                    <small>Comando Central · hace 5 min</small>
                </div>
                <div class="list-item">
                    <div class="list-item-title">Parte PAR-441 ingresado</div>
                    <small>Unidad Sur · hace 12 min</small>
                </div>
                <div class="list-item">
                    <div class="list-item-title">Validación completada en EVT-200</div>
                    <small>Fiscalía · hace 28 min</small>
                </div>

            </div>
        </div>

    </div>

</div>

<!-- ==========================
     SCRIPTS
========================== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% block script %}{% endblock %}
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&libraries=places"></script>

</body>
</html>
